<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.zerock.myapp.mapper.UsersMapper">

	
	
	<resultMap type="org.zerock.myapp.domain.UsersDTO" id="usersMap">
		<id property="ID" column="id" />
		<result property="ID" column="id" />
		<result property="nickName" column="nickname" />
		<result property="name" column="name" />
		<result property="password" column="password" />
		<result property="gender" column="gender" />
		<result property="EMail" column="email" />
		<result property="phoneNumber" column="phonenumber" />
		<result property="birthDate" column="birthdate" />
		<result property="userRegiDate" column="userregidate" />
		<result property="withDrawal" column="withdrawal" />
		<result property="MBTI" column="mbti" />
		<result property="likeArea" column="likearea" />
		<result property="uno" column="uno" />
		<result property="enabled" column="enabled" />
		<collection property="authList" resultMap="authMap"></collection>
		
	</resultMap>
	
	<resultMap type="org.zerock.myapp.domain.AuthDTO" id="authMap">
		<result property="userId" column="userid" />
		<result property="auth" column="auth" />
	</resultMap>

	<select id="select" resultMap="usersMap">
		SELECT u.*,a.auth FROM tbl_users u LEFT OUTER JOIN tbl_users_auth a ON u.id = a.userid
		WHERE u.id=#{ID}
	</select>
	
	 




	<insert id="insert">

		INSERT INTO tbl_users 
				(id, nickname, name, 
				password, gender, email, 
				phonenumber, birthdate, MBTI, likeArea )
		VALUES (#{ID}, #{nickName}, #{name},
			#{password}, #{gender}, #{EMail},
			#{phoneNumber}, #{birthDate}, #{MBTI}, #{likeArea} )
		
	</insert>

	

	<delete id="delete">
		DELETE FROM tbl_users
		WHERE id = #{ID}
	</delete>

	<update id="update">
		UPDATE tbl_users
		SET
			nickname=#{nickName},
			name = #{name},
			password=#{password},
			email=#{EMail},
			phoneNumber=#{phoneNumber}
			<if test="MBTI != null">
				,MBTI=#{MBTI}
			</if>
			<if test="likeArea != null">
				,likeArea=#{likeArea}
			</if>
			
		WHERE id = #{ID}
	</update>




</mapper>